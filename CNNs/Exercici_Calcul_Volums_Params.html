<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<!--This file was converted to xhtml by LibreOffice - see https://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.-->

<head profile="http://dublincore.org/documents/dcmi-terms/">
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/>
<title xml:lang="en-US">- no title specified</title>
<meta name="DCTERMS.title" content="" xml:lang="en-US"/>

<meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/>
<meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/>

<meta name="DCTERMS.issued" content="2024-10-21T09:30:28.095069470" scheme="DCTERMS.W3CDTF"/>

<meta name="DCTERMS.modified" content="2024-10-21T11:18:06.130490264" scheme="DCTERMS.W3CDTF"/>


<meta name="xsl:vendor" content="libxslt"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/>
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/>
<link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/>
<link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/>

<style>
    table { border-collapse:collapse; border-spacing:0; empty-cells:show }
    td, th { vertical-align:top; font-size:12pt;}
    h1, h2, h3, h4, h5, h6 { clear:both;}
    ol, ul { margin:0; padding:0;}
    li { list-style: none; margin:0; padding:0;}
    span.footnodeNumber { padding-right:1em; }
    span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
    span.heading_numbering { margin-right: 0.8rem; }* { margin:0;}
    .paragraph-P1{ font-size:18pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:'Liberation Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P10{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P11{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P12{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P13{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P14{ font-size:14pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.0972in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P15{ font-size:12pt; line-height:115%; margin-bottom:0in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P16{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P17{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P18{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P19{ font-size:12pt; line-height:115%; margin-bottom:0in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P2{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;font-style:italic; }
    .paragraph-P20{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P21{ font-size:12pt; line-height:115%; margin-bottom:0in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P22{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P23{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'Liberation Serif'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P24{ font-size:14pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.0972in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P25{ font-size:14pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.0972in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P26{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P27{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'Liberation Serif'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P28{ font-size:12pt; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P3{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;font-style:italic; }
    .paragraph-P4{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'Liberation Serif'; writing-mode:horizontal-tb; direction:ltr;font-style:italic; }
    .paragraph-P5{ font-size:18pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:'Liberation Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P6{ font-size:16pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.139in; font-family:'Liberation Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P7{ font-size:12pt; line-height:115%; margin-bottom:0.0972in; margin-top:0in; font-family:'Liberation Serif'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P8{ font-size:14pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.0972in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .paragraph-P9{ font-size:12pt; line-height:115%; margin-bottom:0in; margin-top:0in; font-family:'IBM Plex Sans'; writing-mode:horizontal-tb; direction:ltr;}
    .text-Bullet_20_Symbols{ font-family:OpenSymbol; }
    .text-T1{ font-family:'IBM Plex Sans'; }
    .text-T10{ font-weight:bold; }
    .text-T12{ font-weight:bold; }
    .text-T13{ font-weight:bold; }
    .text-T14{ font-weight:normal; }
    .text-T15{ font-weight:normal; }
    .text-T17{ font-weight:bold; }
    .text-T18{ font-family:'IBM Plex Sans'; }
    .text-T19{ font-family:'IBM Plex Sans'; }
    .text-T2{ font-family:'IBM Plex Sans'; }
    .text-T20{ font-family:'IBM Plex Sans'; }
    .text-T21{ font-family:'IBM Plex Sans'; font-weight:bold; }
    .text-T22{ font-family:'IBM Plex Sans'; font-weight:bold; }
    .text-T23{ font-family:'IBM Plex Sans'; font-weight:bold; }
    .text-T24{ font-weight:bold; }
    .text-T5{ font-family:'IBM Plex Sans'; }
    .text-T9{ font-weight:bold; }
    /* ODF styles with no properties representable as CSS:
    .dp1 .Numbering_20_Symbols .T11 .T16 .T3 .T4 .T6 .T7 .T8  { } */
</style>
</head>

<body dir="ltr" style="max-width:11.6902in;margin-top:0.3228in; margin-bottom:0.7807in; margin-left:0.3957in; margin-right:0.2945in; ">
<h1 class="paragraph-P1"><a id="a__Exercise"><span/></a>Exercise</h1>

<p class="paragraph-P2">Consider the following CNN: </p>
<ol><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">1.</span>An input layer withe 32x32x3<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">2.</span>A first Convolutional layer 1 with F=5, S=1, P=0 with 8 filters<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">3.</span>A Pooling layer 1 with F=2 and S=2<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">4.</span>A Convolutational Layer 2 with F=5, S=1, P=0 with 16 filters<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">5.</span>A Pooling layer 2 with F=2 and S=2<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">6.</span>A Full Connected layer 1 with 120 neurons<span class="odfLiEnd"/> </p></li><li><p class="P3" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">7.</span>A Full Connected layer 2 with 84 neurons<span class="odfLiEnd"/> </p></li><li><p class="P4" style="margin-left:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:left;min-width:0.635cm;">8.</span><span class="text-T1">Finally a final Output layer with 10 units that uses </span><span class="text-T2">S</span><span class="text-T1">oftmax</span><span class="odfLiEnd"/> </p></li></ol><h1 class="paragraph-P5"><a id="a__Càlcul_de_Volums_de_sortida_i_Número_de_paràmetres"><span/></a>Càlcul de Volums de sortida <span class="text-T3">i Número de paràmetres</span></h1>
<h2 class="paragraph-P6"><a id="a__Layer_d’entrada"><span/></a>Layer <span class="text-T4">d’entrada</span></h2>

<p class="paragraph-P7"><span class="text-T5">La imatge d’entrada és una imatge de </span><span class="text-T1">32×32×3 (3 </span><span class="text-T5">canals de </span><span class="text-T1">RGB). </span></p>
<h2 class="paragraph-P6"><a id="a__Convolutional_Layer__Conv_Layer_1_"><span/></a>Convolutional Layer (Conv Layer 1)</h2>
<h3 class="paragraph-P8"><a id="a__Càlcul_del_volum"><span/></a>Càlcul del volum</h3>
<ul><li><p class="P9" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Filter size F=5 (<span class="text-T6">cada filtre és de </span>5x5)<span class="odfLiEnd"/> </p></li><li><p class="P9" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Stride S=1.<span class="odfLiEnd"/> </p></li><li><p class="P9" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Padding P=0 (no <span class="text-T6">hi ha </span>padding).<span class="odfLiEnd"/> </p></li><li><p class="P10" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Nú<span class="text-T6">mero de </span>filtr<span class="text-T6">e</span>s = 8, <span class="text-T6">vol dir que es generaran 8 activa</span><span class="text-T3">t</span><span class="text-T6">ion maps </span><span class="text-T3">de sortida.</span><span class="odfLiEnd"/> </p></li></ul>
<p class="paragraph-P11"><span class="text-T3">P</span><span class="text-T6">er tant, </span><span class="text-T7">a</span><span class="text-T8">mb la fórmula tenim</span> <span class="text-T9">(W−F+2P)​/</span><span class="text-T10">S</span><span class="text-T9">+1</span> <span class="text-T8">tenim el volum </span>=(32−5+2×0)/<span class="text-T11">1</span>​+1=28.</p>

<p class="paragraph-P12"><span class="text-T8">Per tant, la sortida del volum és </span>28×28. <span class="text-T8">Com que tenim 8 filtres, llavors </span><span class="text-T12">28x28x8</span><span class="text-T8">.</span></p>
<h3 class="paragraph-P8"><a id="a__Càlcul_de_Número_de_Paràmetres"><span/></a>Càlcul de Número de Paràmetres</h3>

<p class="paragraph-P13">Tenim 8 filtres de 5x5x3 per tant es necessiten 8x(5x5x3)=600 weights i per cada filtre necessitem 1 bias, per tant, en total tenim <span class="text-T9">608 paràmetres</span>. </p>
<h2 class="paragraph-P6"><a id="a__Pooling_Layer__Pooling_Layer_1_"><span/></a>Pooling Layer (Pooling Layer 1)</h2>
<h3 class="paragraph-P14"><a id="a__Càlcul_del_volum"><span/></a>Càlcul del volum</h3>
<ul><li><p class="P15" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Filter size F=2.<span class="odfLiEnd"/> </p></li><li><p class="P16" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Stride S=2.<span class="odfLiEnd"/> </p></li></ul>
<p class="paragraph-P12"><span class="text-T8">Aquestes layers redueixen l’entrada en altura i amplada no en profunditat. Amb la fórmula </span><span class="text-T9">(W−F)/</span><span class="text-T13">S</span><span class="text-T9">​+1</span><span class="text-T14">, </span><span class="text-T15">tenim el volum </span>=(28−2)​/<span class="text-T16">2</span>+1=<span class="text-T8">14.</span></p>

<p class="paragraph-P17"><span class="text-T8">Per tant la sortida és</span>: <span class="text-T8">14</span><span class="text-T16">×</span><span class="text-T8">14</span>×8, <span class="text-T8">pq mantenim la profunditat</span><span class="text-T16">.</span></p>
<h3 class="paragraph-P14"><a id="a__Càlcul_de_Número_de_Paràmetres"><span/></a>Càlcul de Número de Paràmetres</h3>

<p class="paragraph-P13">Les layers de pooling no tenen weights ni bias, fan càlculs de màxim o la mitja entre les caselles de l’entrada.</p>
<h2 class="paragraph-P6"><a id="a__Convolutional_Layer__Conv_Layer_2_"><span/></a>Convolutional Layer (Conv Layer 2)</h2>
<h3 class="paragraph-P14"><a id="a__Càlcul_del_volum"><span/></a>Càlcul del volum</h3>

<p class="paragraph-P18">Tenim una entrad<span class="text-T4">a </span>de 14x14x8.</p>
<ul><li><p class="P19" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Filter size F=5 <span class="odfLiEnd"/> </p></li><li><p class="P19" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Stride S=1.<span class="odfLiEnd"/> </p></li><li><p class="P19" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Padding P=0 (no <span class="text-T8">hi ha </span>padding).<span class="odfLiEnd"/> </p></li><li><p class="P20" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Nú<span class="text-T6">mero de </span>filtr<span class="text-T6">e</span>s = 16, <span class="text-T3">vol dir que tindrem 16 Activation Maps de sortida</span><span class="odfLiEnd"/> </p></li></ul>
<p class="paragraph-P11"><span class="text-T3">P</span><span class="text-T6">er tant, </span> <span class="text-T8">Amb la fórmula tenim</span> <span class="text-T9">(W−F+2P)​/</span><span class="text-T10">S</span><span class="text-T9">+1</span> <span class="text-T8">tenim el volum </span><span class="text-T3">(14-5+0)+1 = 10.</span></p>

<p class="paragraph-P11"><span class="text-T8">Per tant la sortida és</span>: <span class="text-T12">1</span><span class="text-T17">0</span><span class="text-T13">×</span><span class="text-T12">1</span><span class="text-T17">0</span><span class="text-T9">×</span><span class="text-T17">16</span><span class="text-T3">.</span></p>
<h3 class="paragraph-P14"><a id="a__Càlcul_de_Número_de_Paràmetres"><span/></a>Càlcul de Número de Paràmetres</h3>

<p class="paragraph-P13">Tenim 16 filtres de 5x5x8 per tant es necessiten 16x(5x5x8)=3200 weights i per cada filtre necessitem 1 bias, per tant, en total tenim <span class="text-T9">3216 paràmetres</span>. </p>
<h2 class="paragraph-P6"><a id="a__Pooling_Layer__Pooling_Layer_2_"><span/></a>Pooling Layer (Pooling Layer 2)</h2>
<h3 class="paragraph-P14"><a id="a__Càlcul_del_volum"><span/></a>Càlcul del volum</h3>

<p class="paragraph-P18">Tenim una entrada de 10x10x16.</p>
<ul><li><p class="P21" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Filter size F=2.<span class="odfLiEnd"/> </p></li><li><p class="P22" style="margin-left:0.7521cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.4991cm;">•</span>Stride S=2.<span class="odfLiEnd"/> </p></li></ul>
<p class="paragraph-P11"><span class="text-T8">Aquestes layers redueixen l’entrada en altura i amplada no en profunditat. Amb la fórmula </span><span class="text-T9">(W−F)/</span><span class="text-T13">S</span><span class="text-T9">​+1</span><span class="text-T14">, </span><span class="text-T15">tenim el volum </span>=(<span class="text-T3">10-2</span>)​/<span class="text-T16">2</span>+1=<span class="text-T3">5</span><span class="text-T8">.</span></p>

<p class="paragraph-P11"><span class="text-T8">Per tant la sortida és</span>: <span class="text-T17">5</span><span class="text-T13">×</span><span class="text-T17">5</span><span class="text-T9">×</span><span class="text-T17">16</span>, <span class="text-T8">pq mantenim la profunditat</span><span class="text-T16">.</span></p>
<h3 class="paragraph-P14"><a id="a__Càlcul_de_Número_de_Paràmetres"><span/></a>Càlcul de Número de Paràmetres</h3>

<p class="paragraph-P13">Les layers de pooling no tenen weights ni bias, fan càlculs de màxim o la mitja entre les caselles de l’entrada.</p>
<h2 class="paragraph-P6"><a id="a__FC1__Aplanar_l’entrada_"><span/></a>FC1 (Aplanar l’entrada)</h2>

<p class="paragraph-P18">L’entrada és de 5x5x16 i tenim 120 neurones disponibles.</p>

<p class="paragraph-P18">Per tant la sortida és de <span class="text-T9">120</span>.</p>
<h3 class="paragraph-P14"><a id="a__Càlcul_de_Número_de_Paràmetres"><span/></a>Càlcul de Número de Paràmetres</h3>

<p class="paragraph-P18">Per aplanar l’entrada necessitem un vector de posicions igual que l’entrada, per tant de 16 posicions.</p>

<p class="paragraph-P18">A l’aplanar la matriu d’entrada amb el vector tenim un vector sortida de 5x5x16= 400 posicions.</p>

<p class="paragraph-P23"><span class="text-T18">Per tant cada neurona rebrà 400 entrades, per tant necessita 400 weights i 400 biases, això implica 400</span><span class="text-T19">x12</span><span class="text-T18">+</span><span class="text-T20">120</span><span class="text-T18"> paràmetres = </span><span class="text-T21">48</span><span class="text-T22">12</span><span class="text-T21">0 </span><span class="text-T23">paràmetres.</span></p>
<h3 class="paragraph-P24"><a id="a__FC2"><span/></a>FC<span class="text-T3">2</span></h3>

<p class="paragraph-P18">Aquesta és una layer connectada completament a l’anterior <span class="text-T7">de 120</span>, i tenim 84 neurones <span class="text-T7">com a sortida.</span></p>

<p class="paragraph-P18">Per tant la sortida és de <span class="text-T9">84</span>.</p>

<p class="paragraph-P18">Cada neurona necessita 120 weights i 120 biases, per tant, en total tenim 120x84 <span class="text-T7">+ 120</span> = <span class="text-T24">10164</span>.</p>
<h3 class="paragraph-P24"><a id="a__Output_Layer"><span/></a>Output Layer</h3>

<p class="paragraph-P18">La sortida té 10 neurones, per tant <span class="text-T9">10</span>.</p>
<h3 class="paragraph-P25"><a id="a__Càlcul_#_Params"><span/></a>Càlcul # Params</h3>

<p class="paragraph-P26">Aquesta és una layer connectada completament a l’anterior <span class="text-T7">de 84</span>, i tenim <span class="text-T7">10 </span>neurones <span class="text-T7">com a sortida</span>.</p>

<p class="paragraph-P27"><span class="text-T18">Cada neurona necessita </span><span class="text-T19">84</span><span class="text-T18"> weights i </span><span class="text-T19">84</span><span class="text-T18"> biases, per tant, en total tenim (10x84</span><span class="text-T19">)</span><span class="text-T18"> + 10  = </span><span class="text-T21">85</span><span class="text-T23">0</span></p>
<p class="paragraph-P28"> </p></body>

</html>
